# Модель генерации описаний одежды для карточки товара 

## Цель: 
По названию и характеристикам одежды сгенерировать развернутое рекламное описание для карточки товара.

---

## Данные: 
- Источник: датасет карточек одежды  (название + характеристики + описание)
- Объем:
    -  Train: **44 727**
    -  Validation: **4 970**

**Пример данных:**
Наименование товара: Кардиган оверсайз укороченный вязаный
Характеристики:
- Вид застежки: пуговицы
- Особенности модели: вязаный; разноцветный; теплый
- Декоративные элементы: пуговицы
- Фактура материала: вязаная
- Комплектация: Кардиган - 1 шт
- Покрой: оверсайз

Описание:
Кардиган оверсаиз укороченныи вязаныи это идеальныи выбор для тех, кто ценит комфорт и стиль. Этот кардиган изготовлен из высококачественных материалов: 50% вискоза, 28% полиэстер и 22% неилон, что обеспечивает не только тепло, но и долговечность. Уникальная вязаная фактура и разноцветныи дизаин придают этому кардигану особыи шарм, делая его отличным дополнением к любому наряду.

Особенностью данного кардигана является его укороченная длина, что делает его идеальным для беременных женщин, а также для тех, кто предпочитает домашнюю или офисную одежду с элементами моды. Пуговицы обеспечивают удобное застегивание, а вязаныи материал придает ему тепло и мягкость.

Этот кардиган подходит для высоких женщин благодаря своему типу ростовки, которыи обеспечивает идеальное сочетание с различными типами фигур. Выбираите этот кардиган для создания стильного и уютного образа в любое время года.

---

## Очистка данных
При помощи регулярных выражений удаляю: 
- размеры
- рекомендаций по уходу
- артикулы
- тэги
- названий брендов
- года

---

## Подходы
Использую 3 подхода: 
- Fine tune seq2seq (rut5-base)
- Fine tune decoder (rugpt3medium_based_on_gpt2)
- RAG (gpt-4 + FAISS)

---

### 1. Fine-tune Seq2Seq (ruT5-base)
- Архитектура: **энкодер–декодер**
- Обучение: *характеристики → описание*

**Результат:**
- Сгенерированный текст получается структурированный, как в карточках товаров. 
- Однако присутсвуют **галлюцинации**: может выдумывать несуществующие характеристики (например, состав: 95% хлопка и 5% эластана из примера 1).
- Также сильно уходит в однообразные клише. Например, часто повторяет фразу *«ищущих комфорт и стиль в повседневнои одежде»*.

---

### 2. Fine-tune Decoder (ruGPT3-medium)
- Архитектура: **causal LM(GPT-like)**

**Результат:**
- Сгенерированный текст получается более развернутым и естественным, по сравнению с T5.
- Однако:
    - Также как T5 модель склона к галлюцинациям.
    - Также как в T5 генерирует много шаблонных фраз.
    - Местами путает факты: «удлинённый крой» вместо «укороченный» в примере 5.
    - Текст содержит много «воды» вместо конкретики.

---

### 3. RAG: FAISS + GPT
- Онлайн подход: модель не хранит все факты внутри весов, а во время генерации делает поиск по базе и подмешивает результаты в подсказку.
  
**RAG-пайплайн:**
- При помощи SentenceTransformers строю эмбеддинги по входным характеристиками товаров в моем датасете, кладу их в FAISS-индекс
- Для нового товара нахожу *k* ближайших примеров по эмбеддингам (FAISS)
- Формирую prompt: добавляю инструкции *«не выдумывать»* и извлечённые примеры как контекст
- Отправляю запрос в GPT (gpt-4)

**Результат:**
- Меньше галлюцинаций, потому что модель видит конкретный контекст
- Текст основан на фактах
- Иногда текст получается слишком «описательным» и повторяет входные данные без добавления разнообразия.

---

## Примеры генерации
### Пример 1
**Input:**
Наименование товара: Блузка нарядная женская
Страна производства: Киргизия
Покрой: оверсайз
Декоративные элементы: блузка органза; блузка нарядная; на новый год
Комплектация: кардиган - 1шт, пояс 1шт

**True target:**
Блузка женская нарядная из органзы от бренда это идеальныи выбор для тех, кто ценит стиль и элегантность. Эта OVERSIZE блузка из прозрачного материала сделанная в стиле кимоно, предлагает уникальныи дизаин с пояснои застежкои, что делает ее идеальным дополнением для любого вечернего образа. Праздничная блузка отлично подходит для мероприятия или празднования Нового года. Благодаря оверсаиз размеру, накидка кимоно подходит для беременных женщин, обеспечивая идеальное сочетание вечернего стиля и изящества. Прозрачная блуза на осень станет незаменимым элементом вашего гардероба в этом сезоне. Благодаря свободному крою, она также подоидет для больших размеров. Легкая и воздушная органза добавит загадочности и шарма вашему образу. Наша накидка отличное решение для делового стиля в офисе, а также смело можете идти в неи на корпоратив! Добавьте необычную яркую вещь в ваш гардероб и ваш день заиграет новыми красками.

**T5:**
Блузка женская нарядная оверсаиз от бренда представляет собои идеальныи выбор для женщин, ищущих комфорт и стиль в повседневнои одежде. Эта блузка выполнена из высококачественного материала, состоящего из 95% хлопка и 5% эластана, что обеспечивает идеальное сочетание удобства и долговечности. Особенностью этои блузки является ее удлиненныи крои, которыи придает еи особыи шарм и делает ее подходящеи как для офисных буднеи, так и для вечерних мероприятии. Благодаря своему универсальному дизаину, она легко сочетается с различными элементами гардероба, позволяя создавать разнообразные образы.

**GPT:**
Блузка женская нарядная от бренда это идеальныи выбор для женщин, ищущих комфорт и стиль в повседневнои одежде. Эта блузка выполнена из высококачественного материала, состоящего на 80% из вискозы и на 20% из полиэстера, что обеспечивает не только мягкость, но и долговечность изделия.

Особенностью даннои модели является ее оверсаиз крои, которыи делает ее универсальнои и подходящеи для любого типа фигуры. Благодаря свободному крою, блузка подходит как для высоких, так и для невысоких женщин, обеспечивая максимальныи комфорт и свободу движении.

Благодаря своему классическому дизаину, эта блузка легко сочетается с различными элементами гардероба, будь то джинсы, брюки или юбки. Вы можете носить ее как с классическими брюками, так и с юбкои или шортами, что позволяет создавать разнообразные образы.

Эта блузка также идеально подходит для беременных женщин благодаря своеи универсальности и комфорту. Она легко адаптируется под любои тип фигуры, подчеркивая ее достоинства и скрывая недостатки.

Выбирая эту блузку, вы получаете не только стильныи и модныи предмет одежды, но и возможность выразить свои индивидуальныи стиль и индивидуальность. Независимо от того, идете ли вы на деловую встречу или на вечеринку, эта блуза станет вашим незаменимым спутником.

**RAG:**
Блузка нарядная женская - это воплощение элегантности и изысканности. Произведенная в Киргизии, эта блузка представляет собой превосходное сочетание качества и стиля. Она выполнена в популярном оверсайз стиле, который подчеркивает вашу индивидуальность и свободу духа.

Особенностью данной модели является использование органзы в качестве декоративного элемента. Этот материал придает блузке воздушность и легкость, делая ее идеальной для создания нарядного образа. Благодаря своему блеску и прозрачности, органза смотрится очень эффектно и празднично, что делает эту блузку идеальной для Нового года или других важных событий.

Комплектация включает в себя кардиган и пояс. Кардиган выполнен в том же стиле, что и блузка, идеально дополняя ее. Пояс поможет акцентировать внимание на вашей талии и придаст образу завершенность.

Эта блузка - идеальный выбор для тех, кто ценит комфорт, качество и стиль. Она подойдет как для вечеринок, так и для повседневного ношения, став ярким акцентом в вашем гардеробе.

---

### Пример 2
**Input:**
Наименование товара: Платье футляр повседневное офисное карандаш
Тип карманов: декоративные карманы
Тип рукава: 3/4
Вырез горловины: платье женское
Покрой: облегающий
Комплектация: Платье - 1 шт

**True target:**
Элегантное короткое платье карандаш в классическом строгом стиле для женщин с большими размерами от IMPERIA krasotok! Это модное и стильное новогоднее платье женское идеально подоидет как для офисных буднеи, так и для корпоративных вечеров. Рукав 34 и вырез делают его универсальным и подходящим для любого времени года. Облегающии крои и длина мини подчеркивают женственные формы, придавая образу изысканность и элегантность. Регулируемое глубокое декольте отлично подходит для кормящих мамочек. Теплое и комфортное платье идеально подходит для зимы, а весеннии цвет добавит свежести и яркости вашему образу. Платье отлично сидит по фигуре и подоидет на работу или выпускнои вечер. Оно может сталь отличным подарком на новыи год или день рождения. Красивое и стильное, это платье подчеркнет вашу уверенность и харизму, делая вас заметнои на любом мероприятии. Не упустите возможность выглядеть нарядно и модном в этом вечернем платье и деловом наряде! Империя красоток.

**T5:**
Платье футляр от бренда представляет собои идеальныи выбор для женщин, ищущих комфорт и стиль в повседневнои одежде. Это платье изготовлено из высококачественного материала, состоящего из 95% хлопка и 5% эластана, что обеспечивает идеальное сочетание удобства и долговечности. Особенностью этого платья является его облегающии крои, которыи подчеркивает фигуру и создает элегантныи силуэт. Платье оснащено декоративными карманами, которые добавляют практичности и функциональности. Благодаря своему универсальному дизаину, оно подходит как для офисных буднеи, так и для вечерних мероприятии, добавляя нотку элегантности и элегантности в ваш образ.

**GPT:**
Платье футляр от бренда это идеальныи выбор для женщин, ищущих комфорт и стиль в повседневнои одежде. Изготовленное из высококачественного хлопка, платье футляр обеспечивает не только мягкость и приятную на ощупь ткань, но и отличную воздухопроницаемость, что особенно важно в жаркую погоду.

Особенностью этои модели является наличие декоративных карманов, которые добавляют уникальныи акцент к дизаину платья, делая его еще более стильным и модным. Декоративные карманы добавляют изюминку в образ, делая его более выразительным и запоминающимся.

Платье футляр от нашего бренда это не просто одежда, это стильныи аксессуар, которыи подчеркнет вашу индивидуальность и добавит нотку элегантности в любои образ. Оно идеально подходит как для повседневного ношения, так и для особых случаев, таких как свадьба, выпускнои или корпоратив.

Независимо от того, ищете ли вы платье футляр для офиса или для вечернего выхода, наше платье футляр станет незаменимым элементом вашего гардероба. Благодаря своему универсальному дизаину, оно легко сочетается с различными элементами одежды, создавая стильные и модные образы.

Классическии фасон платья футляр позволяет легко сочетать его с различными элементами гардероба, что делает его универсальным выбором для любого случая. Вы можете носить его как с брюками, так и с юбкои, что позволяет создавать разнообразные образы.

**RAG:**
Это изысканное платье-футляр идеально подходит для офиса и повседневной носки. Изготовленное из высококачественного материала, оно обеспечивает комфорт в течение всего дня. Силуэт "карандаш" облегает фигуру, подчеркивая ее достоинства и скрывая недостатки. 

3/4 рукава добавляют модели изящество, а декоративные карманы - оригинальность. Платье обладает круглым вырезом горловины, что делает его универсальным для различных аксессуаров. 

Это платье - отличный выбор для тех, кто ценит комфорт и хочет выглядеть стильно в любой ситуации. Оно легко сочетается с различными предметами гардероба и аксессуарами, позволяя создавать уникальные образы каждый день. 

Платье-футляр - это классический и в то же время современный вариант, который никогда не выходит из моды. Оно станет незаменимым предметом в вашем гардеробе, обеспечивая вам стильный и профессиональный образ на работе и за ее пределами.

---

### Пример 3
**Input:**
Наименование товара: Джинсы бананы зауженные к низу
Особенности модели: зауженные
Декоративные элементы: без элементов
Тип карманов: накладные
Комплектация: Джинсы бананы 1 шт

**True target:**
Хочешь быть в тренде и выглядеть стильно? Тогда обрати внимание на наши джинсы мужские! Мы предлагаем широкии выбор моделеи, включая джинсы мужские зауженные к низу. Наши джинсы отличаются высоким качеством материалов и прекраснои посадкои.

Джинсы мужские синие это классика, которая никогда не выидет из моды. А если ты хочешь добавить немного оригинальности в свои образ, попробуи наши зауженные джинсы мужские. Они подчеркнут твою фигуру и придадут образу утонченность.

Не упускаи возможность выглядеть стильно и модно каждыи день! Выбираи бананы мужские от нашего бренда и будь в центре внимания.

**T5:**
Джинсы бананы зауженные к низу от бренда представляют собои идеальныи выбор для мужчин, ищущих комфорт и стиль в повседневнои одежде. Эти джинсы выполнены из высококачественного материала, состоящего из хлопка и эластана, что обеспечивает идеальное сочетание удобства и долговечности. Застежка на молнию и пуговицу обеспечивает легкость надевания и снятия, а накладные карманы добавляют практичности и функциональности. Особенностью этих джинсов является их зауженныи крои, которыи подчеркивает фигуру и создает элегантныи и модныи образ. Они оснащены накладными карманами, что делает их практичными и удобными для хранения мелочеи. Благодаря своему универсальному дизаину, джинсы бананы от нашего бренда станут незаменимым элементом вашего гардероба, подходя как для повседневного использования, так и для особых случаев.

**GPT:**
Джинсы женские бананы от бренда это идеальныи выбор для женщин, ищущих комфорт и стиль в повседневнои одежде. Эти джинсы выполнены из высококачественного материала, состоящего на 80% из хлопка и на 20% из эластана, что обеспечивает не только удобство ношения, но и долговечность изделия. Джинсы женские с высокои посадкои и зауженными штанинами создают элегантныи и модныи образ, подходящии как для повседневного ношения, так и для вечерних мероприятии.

Изготовленные из высококачественного денима, эти джинсы женские бананы обеспечивают не только комфорт, но и стильныи внешнии вид. Они подходят для любого сезона, будь то осень или зима, а также для демисезонного периода. Джинсы мужские бананы имеют зауженныи крои, что делает их универсальными для любого типа фигуры.

Эти джинсы мужские бананы являются идеальным выбором для тех, кто ценит качество и стиль в одежде. Они изготовлены из высококачественного хлопка, которыи обеспечивает отличную воздухопроницаемость и комфорт в течение всего дня. Джинсы джинсовые женские бананы имеют классическии дизаин, которыи легко сочетается с другими элементами гардероба.

Джинсовые джинсы бананы от нашего бренда это не просто одежда, это стильныи элемент гардероба, которыи подчеркнет ваш индивидуальныи стиль и добавит уверенности в любои ситуации.

**RAG:**
Джинсы бананы зауженные к низу - это отличный выбор для тех, кто следит за модными трендами. Данная модель выполнена без декоративных элементов, что делает их универсальными и подходящими для любого образа. Классические накладные карманы обеспечивают удобство и функциональность, позволяя хранить небольшие предметы. Джинсы изготовлены из качественного материала, который обеспечивает долговечность и комфорт при носке. Прямой крой и зауженные к низу штанины подчеркнут достоинства фигуры и придадут образу непринужденной элегантности. Джинсы идеально сочетаются с различной верхней одеждой и обувью, позволяя создавать как повседневные, так и деловые образы. Выберите размер по размерной сетке производителя для идеальной посадки.

---

### Пример 4
**Input:**
Наименование товара: Спортивный костюм теплый с начесом
Утеплитель: Футер с начесом
Температурный режим: от +10 °C до -5 °C
Плотность синтетического утеплителя: 280 г/кв.м
Страна производства: Узбекистан
Вид застежки: шнуровка
Особенности модели: с начесом
Декоративные элементы: без элементов
Тип карманов: прорезные
Покрой: оверсайз
Комплектация: Худи - 1 шт; Брюки - 1 шт

**True target:**
Базовыи теплыи спортивныи костюм для мужчин больших размеров от белорусского бренда. Утепленныи однотонныи мужскои комплект выполнен из хлопкового футера и состоит из худи и брюк джоггеров. Штаны с резинкои внизу брючин, с завязками на поясе, двумя прорезными карманами по бокам изделия. Внутри пояса спортивок - эластичная тесьма и шнурок - завязка, которыи позволяет регулировать ширину в талии. Худи оверсаиз силуэта, с глубоким капюшоном. Костюм подходит для прогулок, занятии спортом и путешествии. Комплект спортивныи с начесом без сомнении понравится любому современному мужчине. Костюм представлен в разных расцветках, что позволяет подобрать образ на любои повод. Стильныи классическии флисовыи мужскои костюм имеет широкии размерныи ряд, что позволяет подобрать модель на любои тип фигуры. Базовыи домашнии спортивныи костюм отличныи выбор для каждого мужчины или подростка. Костюм доступен в различных размерах, что позволяет подобрать идеальныи вариант для любого роста и комплекции. Благодаря универсальному дизаину и качественным материалам, мужскои костюм на флисе станет незаменимои частью гардероба для тех, кто выбирает теплые вещи и стильные решения. Этот зимнии спортивныи костюм не только поддерживает ваш активныи образ жизни, но и подчеркивает ваш стиль, делая его идеальным выбором для современных мужчин.

**T5:**
Спортивныи костюм мужскои теплыи с начесом от бренда представляет собои идеальныи выбор для мужчин, ищущих комфорт и стиль в повседневнои одежде. Этот костюм изготовлен из высококачественного материала, состоящего из хлопка и полиэстера, что обеспечивает не только тепло, но и долговечность изделия. Особенностью этого костюма является его оверсаиз крои, которыи обеспечивает свободу движении и удобство при носке. Костюм оснащен прорезными карманами и шнуровкои для удобства надевания и снятия, а также удобными карманами для хранения мелочеи. Прорезные карманы добавляют практичности и функциональности, позволяя хранить необходимые мелочи под рукои. Отсутствие декоративных элементов и рисунков делает этот костюм универсальным и легко сочетаемым с другими элементами гардероба.

**GPT:**
Спортивныи костюм мужскои теплыи это идеальныи выбор для тех, кто ценит комфорт и стиль в повседневнои жизни. Этот костюм выполнен из высококачественного материала, состоящего на 70% из хлопка и на 30% из полиэстера, что обеспечивает не только мягкость, но и долговечность изделия.

Костюм мужскои спортивныи состоит из худи с капюшоном и брюк джоггеров, что делает его идеальным выбором для активного образа жизни. Брюки джоггеры оснащены удобными прорезными карманами, что делает их практичными для хранения мелочеи.

Спортивная кофта с длинным рукавом и брюками джоггерами это не просто одежда, это стильныи и функциональныи элемент гардероба, которыи подоидет как для повседневного ношения, так и для активного отдыха на свежем воздухе.

Мужскои костюм теплыи подходит для любого сезона, будь то осень, зима или весна. Он легко сочетается с различными элементами гардероба, позволяя создавать разнообразные образы.

Брюки джоггера с высокои посадкои обеспечивают комфорт и свободу движении, что особенно важно для мужчин, предпочитающих активныи образ жизни. Спортивныи комплект мужскои утепленныи это не только одежда, но и стильныи аксессуар, которыи подчеркнет ваш индивидуальныи стиль.

**RAG:**
Спортивный костюм с начесом от узбекистанского производителя - это сочетание комфорта и стиля. Костюм выполнен из качественного футера с начесом, который отличается особенной мягкостью и теплотой. Плотность материала составляет 280 г/кв.м, что обеспечивает комфортную носку в условиях от +10 °C до -5 °C. 

В комплект входит худи и брюки, оба предмета выполнены в стиле оверсайз, что обеспечивает свободу движения и универсальность. Худи снабжен шнуровкой, которая позволяет регулировать посадку изделия по фигуре. Брюки имеют удобную шнуровку на талии и прорезные карманы для хранения мелких предметов.

Костюм не имеет декоративных элементов, что подчеркивает его минималистичный и современный дизайн. Мягкий и теплый спортивный костюм с начесом будет незаменимым вариантом для занятий спортом на свежем воздухе, активных прогулок или просто для комфортного отдыха дома.

---

### Пример 5
**Input:**
Наименование товара: Кардиган оверсайз укороченный вязаный
Вид застежки: пуговицы
Особенности модели: вязаный; разноцветный; теплый
Декоративные элементы: пуговицы
Фактура материала: вязаная
Комплектация: Кардиган - 1 шт
Покрой: оверсайз

**True target:**
Кардиган оверсаиз укороченныи вязаныи это идеальныи выбор для тех, кто ценит комфорт и стиль. Этот кардиган изготовлен из высококачественных материалов: 50% вискоза, 28% полиэстер и 22% неилон, что обеспечивает не только тепло, но и долговечность. Уникальная вязаная фактура и разноцветныи дизаин придают этому кардигану особыи шарм, делая его отличным дополнением к любому наряду.

Особенностью данного кардигана является его укороченная длина, что делает его идеальным для беременных женщин, а также для тех, кто предпочитает домашнюю или офисную одежду с элементами моды. Пуговицы обеспечивают удобное застегивание, а вязаныи материал придает ему тепло и мягкость.

Этот кардиган подходит для высоких женщин благодаря своему типу ростовки, которыи обеспечивает идеальное сочетание с различными типами фигур. Выбираите этот кардиган для создания стильного и уютного образа в любое время года.

**T5:**
Кардиган женскии оверсаиз укороченныи от бренда это идеальныи выбор для тех, кто ценит комфорт и стиль в повседневнои одежде. Этот кардиган выполнен из высококачественного материала, состоящего из 95% шерсти и 5% акрила, что обеспечивает не только тепло, но и долговечность изделия. Особенностью даннои модели являются пуговицы, придающие еи особыи шарм и элегантность. Укороченная длина делает его универсальным элементом гардероба, которыи легко комбинируется с различными элементами одежды, позволяя создавать разнообразные образы.

**GPT:**
Кардиган женскии укороченныи вязаныи от бренда это идеальныи выбор для женщин, ищущих комфорт и стиль в повседневнои одежде. Этот кардиган выполнен из высококачественного материала, состоящего из шерсти и полиэстера, что обеспечивает не только тепло, но и мягкость на ощупь.

Особенностью даннои модели является удлиненныи крои, которыи делает его универсальным элементом гардероба, подходящеи как для повседневного ношения, так и для особых случаев. Кардиган имеет длинные рукава, что добавляет ему элегантности и позволяет легко сочетать его с различными элементами одежды.

Классическии дизаин этого кардигана позволяет легко адаптировать его под любои стиль одежды, будь то классическии кэжуал или более современныи спортивныи. Благодаря своему универсальному дизаину, этот кардиган станет незаменимои частью гардероба каждои модницы.

Выбирая этот кардиган, вы получаете не только модныи и стильныи предмет одежды, но и практичную и функциональную вещь, которая прослужит вам не один сезон. Благодаря своеи универсальности, кардиган легко сочетается с различными элементами гардероба, позволяя создавать разнообразные образы.

Не упустите возможность обновить свои гардероб с помощью этого кардигана, которыи станет отличным выбором для тех, кто ценит качество, стиль и комфорт.

**RAG:**
Кардиган оверсайз - это универсальный выбор для любой погоды. Эта модель кардигана отличается укороченным кроем, который придает образу изюминку и оригинальность. Вязаный материал предоставляет тепло и комфорт в прохладные дни, а разноцветный дизайн позволяет выделиться из толпы и подчеркнуть вашу индивидуальность. 

Основная особенность этой модели - оверсайз. Благодаря свободному крою, кардиган не стесняет движений и придает образу расслабленности и непринужденности. Пуговицы на передней стороне позволяют регулировать тепло и вентиляцию, а также являются стильным декоративным элементом.

Вязаный кардиган - идеальный вариант для тех, кто ценит комфорт и стиль. Он легко сочетается с различными элементами гардероба, будь то джинсы, юбка или платье. Кардиган оверсайз укороченный вязаный - это модный и актуальный элемент гардероба, который подойдет как для повседневной жизни, так и для особых случаев. Пополните свою коллекцию одежды этим прекрасным кардиганом и радуйте себя новыми стильными образами каждый день!

---

## Проблемы офлайн подходов (ruT5, ruGPT3): 
Проблема в том, что в реальных описаниях часто встречается информация, которой нет в характеристиках товара. Поэтому модель, обученная на таких данных, склонна «выдумывать» детали, которые она встречала в обучающем корпусе, но которых на самом деле в текущем товаре нет.

Можно было бы конечно дополнительно почистить датасет: например, убирать из описаний состав, если его нет в характеристиках, или наоборот добавлять недостающие атрибуты вроде пола. Можно собрать и больше данных.

Но это всё не решает проблему до конца, тк модель сама по себе предсказывает наиболее вероятное продолжение текста, те опирается на статистику текста, а не факты. Если модель часто встречала *«удлинённый крой»* в обучении, то она с большой вероятностью выдаст данную комбинацию, даже если это противоречит реальной характеристике *«укороченный»*.

В офлайн подходе модели обуяаются заранее и хранят все знания в весах. Если появляются новые данные, нужно заново обучать или дообучать модель, что также является серьезгным ограничением.

---

## Итог:
Подход RAG + GPT является наиболее оптимальным и безопасным для задачи генерации описания для карочки товара, так как даёт наиболее правдивые описания, поскольку генерация опирается на извлечённые из базы факты.

---

## Струкура файлов: 

├─ notebooks/
│  ├─ 0_clean_dataset.ipynb          # очистка текста
│  ├─ 1_rut5_finetune.ipynb          # seq2seq (ruT5)
│  ├─ 2_gpt_lora_finetune.ipynb      # GPT-like + LoRA
│  └─ 3_rag_faiss_gpt.ipynb          # RAG (FAISS + GPT)
│
├─ data/
│  └─ df_sample_pred.csv             # сэмпл из 200 примеров для сравнения генераций
│
├─ requirements.txt
├─ LICENSE
└─ README.md

---

## Датасеты и артефакты:

Тяжёлые файлы весов моделей (`pytorch_model.bin`, `model.safetensors` и т.д.), а также большие датасеты не загружены в репозиторий из-за их размера.  

Вместо этого доступны ссылки на Google Drive:

- [Исходный датасет после предобработки (data_cleaned_short.csv)](https://drive.google.com/file/d/1O7VgSwjKeVjcar7116to1vgylWC3ugOb/view?usp=sharing)  
- [База RAG: характеристики + описания + эмбеддинги (embeddings.parquet)](https://drive.google.com/file/d/1vxjBsV_kEd6fNU9g3F8l0TEcl0cLZnBr/view?usp=sharing)  
- [FAISS-индекс для RAG (final_idx.index)](https://drive.google.com/file/d/1tW0x7bL4PJmpqxppY4iI9e5X2nDUmti9/view?usp=sharing)

---

## Лицензия
Код в данном репозитории распространяется по лицензии [MIT](./LICENSE).

- Базовые модели (`ruT5`, `ruGPT3-medium`) загружаются с HuggingFace и распространяются по их лицензиям.  
- Данные (`data/`) предоставлены исключительно для исследовательских целей и не предназначены для коммерческого использования.  
